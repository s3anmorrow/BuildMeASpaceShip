var AsteroidStage=function(){function E(){if(!(f>=t))for(var n=0;r>n;n++)if(!m[n].active){var a=m[n];a.gotoAndPlay("asteroid"+i(1,3)),a.y=-85,a.x=n%2===0?i(100,200):i(400,500),a.active=!0,a.moving=!0,a.addEventListener("mousedown",A),w.addChild(a),f++;var s=1;1===i(0,1)&&(s=-1),createjs.Tween.get(a,{loop:!0}).to({rotation:360*s},1e3*i(15,25));break}}function A(e){var t=e.target;t.removeEventListener("mousedown",A),s.fireMe(t,w),t.gotoAndPlay(t.currentAnimation+"Killed"),t.addEventListener("animationend",b),t.moving=!1,g++;var r=t.bitmapText;r.text=String(g),r.alpha=1,r.x=t.x-r.getBounds().width/2-4,r.y=t.y-44,w.addChild(r),createjs.Tween.get(r).wait(500).to({alpha:0},500).call(y),n.getSound("laser").play(),n.getSound("asteroidExplode").play()}function b(e){if(e.target.stop(),e.target.removeAllEventListeners(),createjs.Tween.removeTweens(e.target),w.removeChild(e.target),e.target.active=!1,g>=t){window.clearInterval(u);for(var n=0;r>n;n++)m[n].removeAllEventListeners();s.flyOffStage(j)}}function y(e){w.removeChild(e.target)}function L(){v=!0,u=window.setInterval(E,c),E()}function j(){createjs.Tween.removeAllTweens(),p.dispatchEvent(d)}var e=4,t=10,r=3,n=window.assetManager,a=window.root,s=window.spaceShip,i=window.randomMe,o=window.background,l=window.BASE_HEIGHT,d=new createjs.Event("onStageComplete",!0),v=!1,u=null,c=1500,f=0,g=0,p=new createjs.Container;p.snapToPixelEnabled=!0;for(var w=new createjs.Container,m=[],h=0;r>h;h++){var S=n.getSprite("assets","asteroid1");S.bitmapText=new createjs.BitmapText("",n.getSpriteSheet("assets")),S.bitmapText.letterSpacing=2,S.active=!1,S.moving=!1,m.push(S)}this.showMe=function(){s.showMeOn(p,232,970),s.flyOnStage(L),s.toggleTurret(!0),o.setMoving(!0),g=0,f=0,p.addChild(w),a.addChild(p)},this.hideMe=function(){v=!1,window.clearInterval(u),s.toggleTurret(!1);for(var e=0;r>e;e++){var t=m[e];t.active=!1,t.removeAllEventListeners(),w.removeChild(t)}a.removeChild(p)},this.pauseMe=function(){window.clearInterval(u)},this.unPauseMe=function(){v&&(u=window.setInterval(E,c))},this.updateMe=function(){if(v)for(var t=0;r>t;t++)if(m[t].moving){var n=m[t];n.y+=e,n.y>l+110&&(n.active=!1,n.moving=!1,n.removeAllEventListeners(),w.removeChild(n),f--)}}};