var AsteroidStage=function(){function b(){if(!(v>=t))for(var n=0;a>n;n++)if(!w[n].active){var r=w[n];r.gotoAndPlay("asteroid"+o(1,3)),r.y=-85,r.x=n%2===0?o(100,200):o(400,500),r.active=!0,r.moving=!0,r.addEventListener("mousedown",C),h.addChild(r),v++;var s=1;1===o(0,1)&&(s=-1),createjs.Tween.get(r,{loop:!0}).to({rotation:360*s},1e3*o(15,25));break}}function C(e){var t=e.target;t.removeEventListener("mousedown",C),s.fireMe(t,h),t.gotoAndPlay(t.currentAnimation+"Killed"),t.addEventListener("animationend",y),t.moving=!1,p++;var a=t.bitmapText;a.text=String(p),a.alpha=1,a.x=t.x-a.getBounds().width/2-4,a.y=t.y-44,h.addChild(a),createjs.Tween.get(a).wait(500).to({alpha:0},500).call(E),n.getSound("laser").play(),n.getSound("asteroidExplode").play()}function y(e){if(e.target.stop(),e.target.removeAllEventListeners(),createjs.Tween.removeTweens(e.target),h.removeChild(e.target),e.target.active=!1,p>=t){window.clearInterval(g);for(var n=0;a>n;n++)w[n].removeAllEventListeners();s.flyOffStage(T)}}function E(e){h.removeChild(e.target)}function j(){c=!0,g=window.setInterval(b,u),b()}function T(){createjs.Tween.removeAllTweens(),f.dispatchEvent(d)}var e=4,t=10,a=3,n=window.assetManager,r=window.root,s=window.spaceShip,o=window.randomMe,i=window.background,l=window.BASE_HEIGHT,d=new createjs.Event("onStageComplete",!0),c=!1,g=null,u=1500,v=0,p=0,f=new createjs.Container;f.snapToPixelEnabled=!0;for(var h=new createjs.Container,w=[],S=0;a>S;S++){var m=n.getSprite("assets","asteroid1");m.bitmapText=new createjs.BitmapText("",n.getSpriteSheet("assets")),m.bitmapText.letterSpacing=2,m.active=!1,m.moving=!1,w.push(m)}this.showMe=function(){s.showMeOn(f,232,970),s.flyOnStage(j),s.toggleTurret(!0),i.setMoving(!0),p=0,v=0,f.addChild(h),r.addChild(f)},this.hideMe=function(){c=!1,window.clearInterval(g),s.toggleTurret(!1);for(var e=0;a>e;e++){var t=w[e];t.active=!1,t.removeAllEventListeners(),h.removeChild(t)}r.removeChild(f)},this.pauseMe=function(){window.clearInterval(g)},this.unPauseMe=function(){c&&(g=window.setInterval(b,u))},this.updateMe=function(){if(c)for(var t=0;a>t;t++)if(w[t].moving){var n=w[t];n.y+=e,n.y>l+110&&(n.active=!1,n.moving=!1,n.removeAllEventListeners(),h.removeChild(n),v--)}}};
